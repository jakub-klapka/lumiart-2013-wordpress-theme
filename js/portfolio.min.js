!function(i){var t={pagination_fade_timeout:300,space_between_columns_desktop:.04,space_between_columns_tablet:.06,lumi_box_corners_offset:15},e={init:function(){this.list=i(".portfolio_list"),this.pagination=i(".portfolio_list_pagination"),this.lis=this.list.find("li"),this.number_of_visible=3,this.number_of_pages=Math.ceil(this.lis.length/this.number_of_visible),this.active_page=1,this.next_button=this.pagination.find(".next"),this.prev_button=this.pagination.find(".prev"),this.pagination_counter_current=this.pagination.find(".page .current"),this.window=i(window),this.page_wrap=i(".page_wrap"),this.indicator_list=i(".portfolio_list_indicator"),this.article_indicator=i(".article_active_indicator"),this.connect_link=this.indicator_list.find(".connect_link"),this.initial_hash=window.location.hash?!0:!1,this.correct_indicator_after_width(),this.setIndicatorTop(),this.bindEvents()},bindEvents:function(){var i=this;this.next_button.on("click.lumi_testimonials",function(){i.active_page<i.number_of_pages&&i.changePage(i.active_page+1)}),this.prev_button.on("click.lumi_testimonials",function(){i.active_page>1&&i.changePage(i.active_page-1)}),this.window.on("resize",function(){i.correct_indicator_after_width(),i.setIndicatorTop()})},changePage:function(i){var e=this,n=this.lis.filter(".visible");n.fadeOut(t.pagination_fade_timeout,function(){n.removeClass("visible");var o=(i-1)*e.number_of_visible,a=o+e.number_of_visible,s=e.lis.slice(o,a);s.fadeIn(t.pagination_fade_timeout,function(){s.addClass("visible"),e.initial_hash&&e.checkShowHideIndicators(!1,!0)&&e.setIndicatorTop()}),e.active_page=i,e.pagination_counter_current.html(e.active_page)}),this.checkShowHideIndicators(i)},correct_indicator_after_width:function(){if("mobile"!==window.lumi_responsive_current){var i="desktop"===window.lumi_responsive_current?t.space_between_columns_desktop:t.space_between_columns_tablet,e=this.page_wrap.width(),n=e*i-2*t.lumi_box_corners_offset;this.connect_link.width(n)}},setIndicatorTop:function(){if("mobile"!==window.lumi_responsive_current){var i=this.lis.filter(".active"),t=i.position();this.indicator_list.css("top",t.top)}},checkShowHideIndicators:function(i,t){i=i?i:this.active_page;var e,n=this.lis.index(this.lis.filter(".active"))+1;return e=n>(i-1)*this.number_of_visible&&n<=i*this.number_of_visible?!0:!1,t?e:void(e?this.indicator_list.add(this.article_indicator).removeClass("list_hidden"):this.indicator_list.add(this.article_indicator).addClass("list_hidden"))},switchActive:function(t){t=i(t),this.lis.filter(".active").removeClass("active"),t.parent("li").addClass("active"),this.checkShowHideIndicators(),this.setIndicatorTop()}},n={init:function(t){this.pagination_instance=t,this.client_content=i(".portfolio_client_content"),this.template_file=this.client_content.data("hb-template-name"),this.list=i(".portfolio_list"),this.bindEvents(),this.checkForHash()},bindEvents:function(){var t=function(t){t.preventDefault();var n=i(this);e.loadClient(n.attr("href"),i(this),n.data("slug"))},e=this;"mobile"!==window.lumi_responsive_current&&this.list.on("click.portfolio_switching","a",t),i(document).on("lumi_responsive_change",function(i){"mobile"===i.new_width&&e.list.off("click.portfolio_switching"),"mobile"===i.old_width&&e.list.on("click.portfolio_switching","a",t)})},checkForHash:function(){var i=window.location.hash;if(i){i=i.substr(1);var t=this.list.find("a").filter("[data-slug="+i+"]");if(t.length>0){if("mobile"===window.lumi_responsive_current)return void(window.location=t.attr("href"));this.loadClient(t.attr("href"),t,t.data("slug"))}}},loadClient:function(t,e,n){this.showHidePreloader("show",e);var o=i.ajax({dataType:"json",url:t+"json/"}),a=this;o.done(function(i){a.processTemplate(i),a.pagination_instance.switchActive(e),a.showHidePreloader("hide",e),window.location.hash=n}),o.fail(function(){alert("Něco nezafungovalo správně, portfolio se otevře v nouzovém režimu a moc nám pomůžete, pokud nám o tom napíšete."),window.location=t})},showHidePreloader:function(i,t){var e=t.find(".preloader");"show"===i?e.addClass("active"):e.removeClass("active")},processTemplate:function(i){var e=Handlebars.templates[this.template_file](i),n=this;this.client_content.fadeOut(t.pagination_fade_timeout,function(){n.client_content.html(e).fadeIn(t.pagination_fade_timeout),n.functionsOnNewDomReady()})},functionsOnNewDomReady:function(){"function"==typeof window.picturefill&&window.picturefill(),"undefined"!=typeof addthis&&"function"==typeof addthis.toolbox&&(addthis.toolbox("#addthis_toolbox"),addthis.counter("#atcounter")),i.event.trigger("lumiart_portfolio_change_loaded")}};i(document).ready(function(){var i=Object.create(e);i.init(),n.init(i)})}(jQuery);